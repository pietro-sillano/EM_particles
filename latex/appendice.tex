\newpage
\definecolor{mygreen}{rgb}{0,0.6,0}
\definecolor{mygray}{rgb}{0.5,0.5,0.5}
\definecolor{mymauve}{rgb}{0.58,0,0.82}
\lstset{
  commentstyle=\color{mygreen},    % comment style
  frame=single,	                   % adds a frame around the code
  keepspaces=true,                 % keeps spaces in text, useful for keeping indentation of code (possibly needs columns=flexible)
  keywordstyle=\color{blue},       % keyword style  
  stringstyle=\color{mymauve},     % string literal style
  showstringspaces=false}


\begin{appendices}
\subsection{Boris Pusher Algorithm}\label{boris}
Uno step di integrazione da $x^n$ e $ v^{n} $ a $x^{n+1}$ e $v^{n+1}$:

$$\mathbf{x}^{n+\frac{1}{2}} = x^{n} + \frac{1}{2}\Delta_t \mathbf{v}^n  \qquad \qquad (drift)$$
$$\mathbf{v}^- = \mathbf{v}^n + \frac{1}{2}\mathbf{E}^{n + \frac{1}{2}}\qquad \qquad (kick)$$
$$\mathbf{v}^+ = \mathbf{v}^- + 2\frac{\mathbf{v}^- + \mathbf{v}^- \times \mathbf{b}}{1 + \mathbf{b}^2} \times  \mathbf{b}\quad  (rotate)$$
$$ \mathbf{v}^{n+1} = \mathbf{v}^+ + \frac{1}{2} \mathbf{E}^{n + \frac{1}{2}}\qquad \qquad (kick)$$
$$ \mathbf{x}^{n+1} = \mathbf{x}^{n+\frac{1}{2}} + \frac{1}{2}\Delta_t \mathbf{v}^{n+1}\qquad \qquad (drift)$$


\subsection{Implementazione singola particella}
\lstinputlisting[language=C++]{../caso1/case1_new.cpp}


\subsection{Implementazione ExB Drift}
\lstinputlisting[language=C++]{../caso2/case2.cpp}


\subsection{Implementazione 10k particelle}
\lstinputlisting[language=C++]{../caso3/borismod.cpp}


\end{appendices}